<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ChatUp - Advanced Chat Interface</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
  /* Theme Toggle Button - Perfectly round with glass effect */
  #theme-toggle {
    background: rgba(255, 255, 255, 0.15) !important;
    backdrop-filter: blur(16px) !important;
    -webkit-backdrop-filter: blur(16px) !important;
    color: #333 !important;
    border: 1px solid rgba(255, 255, 255, 0.25) !important;
    width: 44px !important;
    height: 44px !important;
    min-width: 44px !important;
    min-height: 44px !important;
    max-width: 44px !important;
    max-height: 44px !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    position: absolute !important;
    top: 1rem !important;
    right: 1rem !important;
    font-size: 1rem !important;
    z-index: 1000 !important;
    margin: 0 !important;
    padding: 0 !important;
    box-shadow: 
      0 8px 32px 0 rgba(31, 38, 135, 0.2) !important,
      inset 0 4px 10px rgba(255, 255, 255, 0.2) !important;
    outline: 1px solid rgba(255, 255, 255, 0.18) !important;
  }

  #theme-toggle:hover {
    background: rgba(255, 255, 255, 0.25) !important;
    transform: scale(1.1) !important;
    box-shadow: 
      0 8px 32px 0 rgba(31, 38, 135, 0.25) !important,
      inset 0 4px 15px rgba(255, 255, 255, 0.3) !important;
  }

  [data-theme="dark"] #theme-toggle {
    background: rgba(255, 255, 255, 0.1) !important;
    border: 1px solid rgba(255, 255, 255, 0.18) !important;
    color: #e0e0e0 !important;
    box-shadow: 
      0 8px 32px 0 rgba(0, 0, 0, 0.3) !important,
      inset 0 4px 10px rgba(255, 255, 255, 0.1) !important;
  }

  [data-theme="dark"] #theme-toggle:hover {
    background: rgba(255, 255, 255, 0.15) !important;
    box-shadow: 
      0 8px 32px 0 rgba(0, 0, 0, 0.4) !important,
      inset 0 4px 15px rgba(255, 255, 255, 0.15) !important;
  }

  /* Theme Toggle Button in Chat User Info */
  .user-info #theme-toggle {
    position: static !important;
    margin-right: 1rem !important;
    top: auto !important;
    right: auto !important;
  }

  /* Theme Variables */
  :root {
    --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --bg-secondary: linear-gradient(135deg, #f0f4f8 0%, #e6e9f0 100%);
    --bg-container: rgba(255, 255, 255, 0.95);
    --bg-sidebar: rgba(255, 255, 255, 0.95);
    --bg-input: #f9f9f9;
    --bg-input-focus: white;
    --text-primary: #333;
    --text-secondary: #666;
    --text-light: #888;
    --border-color: #e0e0e0;
    --border-light: rgba(0, 0, 0, 0.05);
    --accent-primary: #667eea;
    --accent-secondary: #764ba2;
    --accent-gradient: linear-gradient(135deg, #667eea, #764ba2);
    --shadow-light: 0 4px 10px rgba(0, 0, 0, 0.08);
    --shadow-medium: 0 5px 15px rgba(0, 0, 0, 0.1);
    --shadow-heavy: 0 20px 40px rgba(0, 0, 0, 0.15);
    --danger: #ff6b6b;
    --success: #4CAF50;
    --info: #2196F3;
  }

  /* Dark theme variables */
  [data-theme="dark"] {
    --bg-primary: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
    --bg-secondary: linear-gradient(135deg, #0f2027 0%, #1a2a3a 100%);
    --bg-container: rgba(25, 25, 35, 0.95);
    --bg-sidebar: rgba(25, 25, 35, 0.95);
    --bg-input: rgba(45, 45, 60, 0.8);
    --bg-input-focus: rgba(55, 55, 70, 0.9);
    --text-primary: #f0f0f0;
    --text-secondary: #c0c0c0;
    --text-light: #a0a0a0;
    --border-color: #4a4d6a;
    --border-light: rgba(255, 255, 255, 0.08);
    --accent-primary: #6a8eff;
    --accent-secondary: #7d9cff;
    --accent-gradient: linear-gradient(135deg, #6a8eff, #7d9cff, #8a9bff);
    --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.4);
    --shadow-medium: 0 8px 25px rgba(0, 0, 0, 0.5);
    --shadow-heavy: 0 20px 40px rgba(0, 0, 0, 0.6);
    --danger: #ff6b6b;
    --success: #50fa7b;
    --info: #79d3ff;
  }

  /* Apply smooth transitions */
  * {
    transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease !important;
  }
  
  /* Apply theme to main elements */
  body {
    background: var(--bg-primary) !important;
    color: var(--text-primary) !important;
  }
  
  .auth-container {
    background: rgba(255, 255, 255, 0.05) !important;
  }
  
  .form-container {
    background: var(--bg-container) !important;
  }
  
  .chat-container {
    background: var(--bg-secondary) !important;
  }
  
  .sidebar {
    background: var(--bg-sidebar) !important;
  }
  
  .chat-header {
    background: var(--bg-container) !important;
  }
  
  .input-container {
    background: rgba(255, 255, 255, 0.25) !important;
    backdrop-filter: blur(16px) !important;
    -webkit-backdrop-filter: blur(16px) !important;
    border-top: 1px solid rgba(255, 255, 255, 0.18) !important;
    box-shadow: 
      0 8px 32px 0 rgba(31, 38, 135, 0.15) !important,
      inset 0 4px 10px rgba(255, 255, 255, 0.2) !important;
  }
  
  [data-theme="dark"] .input-container {
    background: rgba(25, 25, 35, 0.25) !important;
    border-top: 1px solid rgba(255, 255, 255, 0.1) !important;
    box-shadow: 
      0 8px 32px 0 rgba(0, 0, 0, 0.3) !important,
      inset 0 4px 10px rgba(255, 255, 255, 0.05) !important;
  }
</style>
</head>
<body>
    <!-- Authentication Container -->
    <div id="auth-container" class="auth-container">
        <div class="form-container">
            <!-- App Logo and Name -->
            <div class="app-header">
                <div class="auth-logo-container">
                    <img src="/images/Logo.png" alt="ChatUp Logo" class="auth-logo">
                </div>
                <h1 class="app-name">ChatUp</h1>
                <button id="theme-toggle" class="theme-toggle-btn" title="Toggle Theme" style="position: absolute; top: 1rem; right: 1rem;">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
            
            <!-- Login/Signup Form -->
            <div id="auth-forms" style="display: block;">
                <div class="form-toggle login-mode">
                    <button id="login-toggle" class="active">Login</button>
                    <button id="signup-toggle">Sign Up</button>
                </div>
                
                <div id="login-form" class="form-content">
                    <h2>Login to Your Account</h2>
                    <form id="loginForm">
                        <div class="input-group">
                            <label for="login-email">Email</label>
                            <input type="email" id="login-email" name="email" required>
                        </div>
                        <div class="input-group">
                            <label for="login-password">Password</label>
                            <div class="password-input-container">
                                <input type="password" id="login-password" name="password" required>
                                <span class="password-toggle" id="toggle-login-password">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                        </div>
                        <button type="submit" class="btn primary">Login</button>
                    </form>
                </div>
                
                <div id="signup-form" class="form-content" style="display: none;">
                    <h2>Create New Account</h2>
                    <form id="signupForm">
                        <div class="input-group">
                            <label for="signup-name">Full Name</label>
                            <input type="text" id="signup-name" name="name" required>
                        </div>
                        <div class="input-group">
                            <label for="signup-email">Email</label>
                            <input type="email" id="signup-email" name="email" required>
                        </div>
                        <div class="input-group">
                            <label for="signup-password">Password</label>
                            <div class="password-input-container">
                                <input type="password" id="signup-password" name="password" required>
                                <span class="password-toggle" id="toggle-signup-password">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="signup-confirm-password">Confirm Password</label>
                            <div class="password-input-container">
                                <input type="password" id="signup-confirm-password" name="confirm-password" required>
                                <span class="password-toggle" id="toggle-signup-confirm-password">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                        </div>
                        <button type="submit" class="btn primary">Sign Up</button>
                    </form>
                </div>
            </div>
            
            <!-- Email Verification Screen -->
            <div id="email-verification" class="verification-container" style="display: none; text-align: center; padding: 2rem;">
                <div class="verification-icon">
                    <i class="fas fa-envelope-open-text" style="font-size: 4rem; color: #667eea; margin-bottom: 1rem;"></i>
                </div>
                <h2 style="color: #333; margin-bottom: 1rem;">Check Your Email</h2>
                <p style="color: #666; margin-bottom: 1rem; line-height: 1.6; font-size: 1.1rem;">
                    We've sent a verification link to your email address.
                </p>
                <div id="verification-email-display" style="font-size: 1.3rem; margin: 1.5rem 0; color: #667eea; font-weight: bold;">
                    <!-- Email will be displayed here -->
                </div>
                <p style="color: #666; margin-bottom: 1.5rem; line-height: 1.6; font-size: 1.1rem;">
                    Please click the link in the email to verify your account and complete registration.
                </p>
                <div class="verification-actions">
                    <button id="back-to-login" class="btn secondary" style="background: #f0f0f0; color: #333; margin-right: 1rem;">Back to Login</button>
                    <button id="resend-email" class="btn primary">Resend Email</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Container -->
    <div id="chat-container" class="chat-container" style="display: none;">
        <div class="app-container">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">Chat History</div>
                    <button id="toggle-sidebar" class="btn toggle-sidebar-btn" title="Toggle Sidebar">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                </div>
                <div class="sidebar-content">
                    <button id="new-chat-btn" class="btn new-chat-btn">
                        <i class="fas fa-plus"></i> New Chat
                    </button>
                    <div id="chat-history-list" class="chat-history-list">
                        <!-- Chat history items will be added here dynamically -->
                    </div>
                </div>
            </div>
            
            <!-- Main Chat Area -->
            <div class="main-chat">
                <div class="chat-header">
                    <button id="show-sidebar-btn" class="btn show-sidebar-btn" title="Show Sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="header-content">
                        <h1>ChatUp</h1>
                        <div class="user-info">
                            <button id="theme-toggle" class="theme-toggle-btn" title="Toggle Theme">
                                <i class="fas fa-moon"></i>
                            </button>
                            <span id="username-display">User</span>
                            <button id="profile-btn" class="btn profile" title="View Profile">
                                <i class="fas fa-user-circle"></i>
                            </button>
                            <button id="logout-btn" class="btn logout">Logout</button>
                        </div>
                    </div>
                </div>
                
                <div class="chat-area">
                    <div class="messages-container" id="messages-container">
                        <!-- Messages will be displayed here -->
                        <div class="welcome-message">
                            <div class="logo-container">
                                <img src="/images/Logo.png" alt="ChatUp Logo" class="welcome-logo">
                            </div>
                            <h2>Welcome to ChatUp!</h2>
                            <p>How can I assist you today?</p>
                        </div>
                    </div>
                </div>
                
                <div class="input-container">
                    <textarea id="message-input" placeholder="Type your message here..." rows="1"></textarea>
                    <button id="send-btn" class="btn send">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Profile Modal -->
    <div id="profile-modal" class="modal-overlay" style="display: none;">
        <div class="profile-modal">
            <div class="profile-header">
                <h2>User Profile</h2>
                <button id="close-profile" class="close-btn">&times;</button>
            </div>
            <div class="profile-content">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-details">
                    <div class="profile-field">
                        <label><i class="fas fa-user"></i> Name</label>
                        <span id="profile-name">Loading...</span>
                    </div>
                    <div class="profile-field">
                        <label><i class="fas fa-envelope"></i> Email</label>
                        <span id="profile-email">Loading...</span>
                        <button id="reveal-email-btn" class="btn secondary small-btn" style="margin-top: 0.5rem; padding: 0.4rem 0.8rem; font-size: 0.85rem;">Reveal Email</button>
                    </div>
                    <div class="profile-field">
                        <label><i class="fas fa-calendar"></i> Member Since</label>
                        <span id="profile-join-date">Loading...</span>
                    </div>
                </div>
            </div>
            <div class="profile-actions">
                <button id="edit-profile-btn" class="btn secondary">Edit Profile</button>
                <button id="change-password-btn" class="btn secondary">Change Password</button>
                <button id="delete-account-btn" class="btn danger">Delete Account</button>
            </div>
        </div>
    </div>
    
    <!-- Change Password Modal -->
    <div id="change-password-modal" class="modal-overlay" style="display: none;">
        <div class="password-modal">
            <div class="password-header">
                <h2>Change Password</h2>
                <button id="close-password" class="close-btn">&times;</button>
            </div>
            <div class="password-content">
                <form id="change-password-form">
                    <div class="input-group">
                        <label for="old-password"><i class="fas fa-lock"></i> Current Password</label>
                        <div class="password-input-container">
                            <input type="password" id="old-password" name="oldPassword" required>
                            <span class="password-toggle" id="toggle-old-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="new-password"><i class="fas fa-key"></i> New Password</label>
                        <div class="password-input-container">
                            <input type="password" id="new-password" name="newPassword" required>
                            <span class="password-toggle" id="toggle-new-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="confirm-new-password"><i class="fas fa-check-circle"></i> Confirm New Password</label>
                        <div class="password-input-container">
                            <input type="password" id="confirm-new-password" name="confirmNewPassword" required>
                            <span class="password-toggle" id="toggle-confirm-new-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <div class="password-actions">
                        <button type="button" id="cancel-password" class="btn secondary">Cancel</button>
                        <button type="submit" class="btn primary">Update Password</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="modal-overlay" style="display: none;">
        <div class="profile-modal">
            <div class="profile-header">
                <h2>Edit Profile</h2>
                <button id="close-edit-profile" class="close-btn">&times;</button>
            </div>
            <div class="profile-content">
                <div class="profile-avatar-container">
                    <div class="profile-avatar-edit">
                        <i class="fas fa-user-circle" id="current-avatar"></i>
                        <div class="avatar-overlay">
                            <i class="fas fa-camera"></i>
                        </div>
                    </div>
                    <p>Click avatar to change</p>
                    <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                </div>
                <div class="profile-details">
                    <div class="input-group">
                        <label for="edit-name"><i class="fas fa-user"></i> Name</label>
                        <input type="text" id="edit-name" name="name" placeholder="Enter your name">
                    </div>
                </div>
            </div>
            <div class="profile-actions">
                <button id="cancel-edit-profile" class="btn secondary">Cancel</button>
                <button id="save-profile" class="btn primary">Save Changes</button>
            </div>
        </div>
    </div>
    
    <!-- Delete Account Confirmation Modal -->
    <div id="delete-account-modal" class="modal-overlay" style="display: none;">
        <div class="delete-account-modal">
            <div class="delete-account-header">
                <h2>Delete Account</h2>
                <button id="close-delete-account" class="close-btn">&times;</button>
            </div>
            <div class="delete-account-content">
                <div class="warning-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>Are you sure you want to delete your account? This action is permanent and cannot be undone.</p>
                </div>
                <div class="input-group">
                    <label for="delete-password"><i class="fas fa-lock"></i> Confirm Password</label>
                    <div class="password-input-container">
                        <input type="password" id="delete-password" name="deletePassword" placeholder="Enter your password" required>
                        <span class="password-toggle" id="toggle-delete-password">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                </div>
                <div class="delete-account-warning">
                    <p>All your data will be permanently deleted. This action cannot be reversed.</p>
                </div>
            </div>
            <div class="delete-account-actions">
                <button id="cancel-delete-account" class="btn secondary">Cancel</button>
                <button id="confirm-delete-account" class="btn danger">Delete Account</button>
            </div>
        </div>
    </div>
    
    <!-- Delete Chat Confirmation Modal -->
    <div id="delete-chat-modal" class="modal-overlay" style="display: none;">
        <div class="delete-chat-modal">
            <div class="delete-chat-header">
                <h2>Delete Chat</h2>
                <button id="close-delete-chat" class="close-btn">&times;</button>
            </div>
            <div class="delete-chat-content">
                <div class="warning-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>Are you sure you want to delete this chat? This action cannot be undone.</p>
                </div>
            </div>
            <div class="delete-chat-actions">
                <button id="cancel-delete-chat" class="btn secondary">Cancel</button>
                <button id="confirm-delete-chat" class="btn danger">Delete Chat</button>
            </div>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logout-modal" class="modal-overlay" style="display: none;">
        <div class="logout-modal">
            <div class="logout-header">
                <h2>Confirm Logout</h2>
                <button id="close-logout" class="close-btn">&times;</button>
            </div>
            <div class="logout-content">
                <div class="warning-message">
                    <i class="fas fa-sign-out-alt"></i>
                    <p>Are you sure you want to logout? You will need to log back in to access your account.</p>
                </div>
            </div>
            <div class="logout-actions">
                <button id="cancel-logout" class="btn secondary">Cancel</button>
                <button id="confirm-logout" class="btn primary">Logout</button>
            </div>
        </div>
    </div>

    <!-- Reveal Email Password Confirmation Modal -->
    <div id="reveal-email-modal" class="modal-overlay" style="display: none;">
        <div class="reveal-email-modal">
            <div class="reveal-email-header">
                <h2>Confirm Password</h2>
                <button id="close-reveal-email" class="close-btn">&times;</button>
            </div>
            <div class="reveal-email-content">
                <div class="input-group">
                    <label for="reveal-email-password"><i class="fas fa-lock"></i> Enter Password</label>
                    <div class="password-input-container">
                        <input type="password" id="reveal-email-password" name="revealPassword" placeholder="Enter your password" required>
                        <span class="password-toggle" id="toggle-reveal-email-password">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                </div>
                <div class="reveal-email-info">
                    <p>Please enter your password to reveal your email address.</p>
                </div>
            </div>
            <div class="reveal-email-actions">
                <button id="cancel-reveal-email" class="btn secondary">Cancel</button>
                <button id="confirm-reveal-email" class="btn primary">Reveal Email</button>
            </div>
        </div>
    </div>

    <script>
    // Simple and reliable theme toggle functionality
    (function() {
        'use strict';
        
        // Apply saved theme on page load
        window.addEventListener('load', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            // Update all toggle buttons with correct icons
            updateAllToggleIcons(savedTheme);
        });
        
        // Global click handler for theme toggle buttons
        document.addEventListener('click', function(e) {
            if (e.target.closest('#theme-toggle')) {
                e.preventDefault();
                e.stopPropagation();
                
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                // Apply new theme
                document.documentElement.setAttribute('data-theme', newTheme);
                
                // Save theme preference
                localStorage.setItem('theme', newTheme);
                
                // Update all toggle buttons
                updateAllToggleIcons(newTheme);
            }
        });
        
        function updateAllToggleIcons(theme) {
            const allToggles = document.querySelectorAll('#theme-toggle');
            allToggles.forEach(function(btn) {
                const icon = btn.querySelector('i.fas');
                if (icon) {
                    if (theme === 'dark') {
                        icon.className = 'fas fa-sun';
                        btn.title = 'Switch to Light Theme';
                    } else {
                        icon.className = 'fas fa-moon';
                        btn.title = 'Switch to Dark Theme';
                    }
                }
            });
        }
    })();
</script>
<script src="js/auth.js"></script>
    <script src="js/chat.js"></script>
</body>
</html>